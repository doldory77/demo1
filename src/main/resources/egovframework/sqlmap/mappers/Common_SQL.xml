<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//iBATIS.com//DTD SQL Map 2.0//EN" "http://www.ibatis.com/dtd/sql-map-2.dtd">

<sqlMap namespace="Common">

	<typeAlias alias="objectToStringHandler" type="demo.cmmn.service.ObjectToStringTypeHandler"/>
	<typeAlias alias="msgTrunkTypeHandler" type="demo.cmmn.service.MsgTrunkTypeHandler"/>
	<typeAlias alias="msgDetailTrunkTypeHandler" type="demo.cmmn.service.MsgDetailTrunkTypeHandler"/>
	<typeAlias alias="egovMap" type="egovframework.rte.psl.dataaccess.util.EgovMap"/>
	<typeAlias alias="packingVO" type="demo.cmmn.service.PackingVO"/>

	<resultMap id="packing" class="demo.cmmn.service.PackingVO">
		<result property="id" column="id"/>
		<result property="timestamp" column="timestamp"/>
		<result property="path" column="path"/>
		<result property="input" column="input" jdbcType="VARCHAR" typeHandler="objectToStringHandler"/>
		<result property="output" column="output" jdbcType="VARCHAR" typeHandler="objectToStringHandler"/>
		<result property="code" column="code"/>
		<result property="msg" column="msg"/>
		<result property="msgDetail" column="msg_detail"/>
	</resultMap>

	<insert id="commonDAO.insertLog" parameterClass="packingVO">
		<![CDATA[
			INSERT INTO LOG 
				( id
				  , timestamp
				  , path
				  , input
				  , output
				  , code
				  , msg
				  , msg_detail )
			VALUES ( #id#
				  , #timestamp#
				  , #path#
				  , #input,handler=objectToStringHandler#
				  , #output#
				  , #code#
				  , #msg,handler=msgTrunkTypeHandler#
				  , #msgDetail,handler=msgDetailTrunkTypeHandler# )
		]]>
	</insert>
	
    <select id="commonDAO.selectLogById" parameterClass="String" resultMap="packing">
        <![CDATA[
            SELECT
                id
                , timestamp
                , path
                , input
                , output
                , code
                , msg
                , msg_detail
            FROM log 
            WHERE id = #id#
        ]]>
    </select>
    
    <select id="commonDAO.selectLogByRange" parameterClass="egovMap" resultMap="packing">
        <![CDATA[
            SELECT
                id
                , timestamp
                , path
                , input
                , output
                , code
                , msg
                , msg_detail
            FROM log 
            WHERE timestamp between #start# and #end#
        ]]>
    </select>

</sqlMap>
